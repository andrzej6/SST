$(document).ready(function (){    /* MOVE CART LAYER INSIDE TO #outer-wrapper */    $('.layer_cart_overlay').prependTo('#cart-layer-wrapper');    $('#layer_cart').prependTo('#cart-layer-wrapper');    /* MOBILE MENU */    $('body').wpMMenu({        navElements : {            'menu' : {                'type' : 'create',                'class' : 'wpicon medium wpicon-menu'            },            'cart' : {                'type' : 'clone',                'class' : 'cart_info_inner'            },            'myaccount' : {               'type' : 'create',               'class' : 'wpicon medium wpicon-user'            }        },        menuElements : [            {                'nav' : 'menu',                'element' : '#language_selector',                'isDetachable' : true            },            {                'nav' : 'menu',                'element' : '#currency_selector',                'isDetachable' : true            },            {                'nav' : 'menu',                'element' : '#header_mobile_menu',                'isDetachable' : false            },            {                'nav' : 'cart',                'element' : '#header_cart_block',                'isDetachable' : true,                'afterDetach' : function(){ $(this).hide(); }            },            {                'nav' : 'myaccount',                'element' : '#mobile_header_user_info',                'isDetachable' : false            },            {                'nav' : 'myaccount',                'element' : '#quick_login',                'isDetachable' : false            },            {                'nav' : 'myaccount',                'element' : '#mobile_myaccount',                'isDetachable' : false            }        ],        pageContainer : '#outer-wrapper',        contentContainer : '#wrapper'    });    /* CATEGORY GRID/LIST SELECTOR */    $('.category-view-type-selector').on('click', function(e){        e.preventDefault();        var viewType = $(this).data('view-type');        if ((viewType === 'grid' && !$('.product-list-grid').hasClass('list')) ||             viewType === 'list' && $('.product-list-grid').hasClass('list')){            return false;        }        changeProductListViewType(viewType);    });    /* INIT CURRENCY SELECTOR */    if ($('#currency_selector').length > 0){        initCurrencySelector();    }    /* INIT LANGUAGE SELECTOR */    if ($('#language_selector').length > 0){        initLanguageSelector();    }    /* INIT STICKY MENU */    initStickyMenu();    /* INIT TABS */    initTabs();    /* INIT FOOTER COLLAPSABLES */    initFooterCollapsables();    /* INIT RESPONSIVE TABLES - modified from Zurb's responsive-tables.js */    var switched = false;    var updateTables = function() {        if (($(window).width() < 767) && !switched ){            switched = true;            $('table.wpresponsive').each(function(i, element) {                splitTable($(element));            });            return true;        }        else if (switched && ($(window).width() > 767)) {            switched = false;            $('table.wpresponsive').each(function(i, element) {                unsplitTable($(element));            });        }    };    $(window).load(updateTables);    $(window).on('redraw',function(){switched=false;updateTables();}); // An event to listen for    $(window).on('resize', updateTables);    function splitTable(original) {        if (original.parent('.wpresponsivetable-wrapper').length == 0) {            original.wrap("<div class='wpresponsivetable-wrapper' />");        }    }    function unsplitTable(original) {        original.unwrap();    }                          $( "#go-to-all-reviews" ).click(function(e) {   	   var $_tabs = $(this).closest('.tabs');   	   e.preventDefault();   	      	   $( ".tabs .tab-title" ).each(function()    	    {          $( this ).removeClass('active');        });   	      	   $( ".tab-content-wrapper" ).each(function()    	    {          $( this ).removeClass('active');        });   	      	   $('.tabs .tab-titles').find("[data-tab='product-tab-7']").addClass('active');        $('#product-tab-7').addClass('active');                        $('html, body').animate({scrollTop: $("#reviews-scroll").offset().top}, 3000);                   });        $( "#p_accesories" ).click(function(e) {   	   var $_tabs = $(this).closest('.tabs');   	   e.preventDefault();   	      	   $( ".tabs .tab-title" ).each(function()    	    {          $( this ).removeClass('active');        });   	      	   $( ".tab-content-wrapper" ).each(function()    	    {          $( this ).removeClass('active');        });   	      	   $('.tabs .tab-titles').find("[data-tab='product-tab-4']").addClass('active');        $('#product-tab-4').addClass('active');                        $('html, body').animate({scrollTop: $("#reviews-scroll").offset().top}, 3000);                   });                                                });function initQuickImageViewer(el){    /* !This function is in the loop! */    var pid = $(el).data('pid');    var linkRewrite = $(el).data('linkrewrite');    var itemImageWrapper = '.item-images-' + pid;    if (!$(el).hasClass("quick-images-loaded"))    {        $.ajax({            type: "POST",            url: baseUri + "modules/wpautumn/wpautumn-ajax.php",            async: true,            dataType: "json",            cache: false,            data: "action=loadImageSources" + "&pid=" + pid + "&linkRewrite=" + linkRewrite,            success: function (result) {                $(itemImageWrapper).append(result);                $(el).addClass("quick-images-loaded");                // Init carousel                $(itemImageWrapper).owlCarousel({                    slideSpeed: 250,                    paginationSpeed: 500,                    rewindSpeed: 600,                    rewindNav : false,                    singleItem: true,                    lazyLoad : true,                    navigation : true,                    pagination: false,                    lazyEffect: false,                    navigationText: ['<span class="wpicon wpicon-chevron-left"></span>', '<span class="wpicon wpicon-chevron-right"></span>']                });                // If autoNext enabled, bind stuff                if (WPAC_quickImageViewerAutoNext == 1) {                    if (!Modernizr.touch) {                        $(itemImageWrapper).closest('.item-wrapper').hover(                            function(){ $(itemImageWrapper).trigger('owl.next')},                            function(){ $(itemImageWrapper).trigger('owl.goTo', 0)}                        );                    }                }            }        });    }}function changeProductListViewType(viewType){    $.ajax({        type: "POST",        url: baseUri + "modules/wpautumn/wpautumn-ajax.php",        async: true,        dataType: "json",        cache: false,        data: "action=changeProductListViewType" + "&viewType=" + viewType,        success: function (result) {            if (result == "grid" || result == "list" || result == "card"){                location.reload();            }else{                alert("Category view could not change, please reload the page and try again!");            }        }    });}function initCurrencySelector(){    var clickHandler = 'click';    if (Modernizr.touch) {        clickHandler = 'touchstart';    }    $('.current_currency').on(clickHandler, function (e) {        if ($('.languages_ul').hasClass('languages_ul_hover')) {            $('.languages_ul').hide().removeClass('languages_ul_hover');            $('.current_language').removeClass('active');        }        if ($('.currencies_ul').hasClass('currencies_ul_hover')) {            $('.currencies_ul').hide().removeClass('currencies_ul_hover');            $('.current_currency').removeClass('active');        } else {            $('.currencies_ul').addClass('currencies_ul_hover').show();            $('.current_currency').addClass('active');        }        e.stopPropagation();    });    $('.currencies_ul').on(clickHandler, function (e) {        e.stopPropagation();    });    $(document).on(clickHandler, function () {        if ($('.currencies_ul').hasClass('currencies_ul_hover')) {            $('.currencies_ul').hide().removeClass('currencies_ul_hover');            $('.current_currency').removeClass('active');        }    });}function initLanguageSelector(){    var clickHandler = 'click';    if (Modernizr.touch) {        clickHandler = 'touchstart';    }    $('.current_language').on(clickHandler, function (e) {        if ($('.currencies_ul').hasClass('currencies_ul_hover')) {            $('.currencies_ul').hide().removeClass('currencies_ul_hover');            $('.current_currency').removeClass('active');        }        if ($('.languages_ul').hasClass('languages_ul_hover')) {            $('.languages_ul').hide().removeClass('languages_ul_hover');            $('.current_language').removeClass('active');        } else {            $('.languages_ul').addClass('languages_ul_hover').show();            $('.current_language').addClass('active');        }        e.stopPropagation();    });    $('.languages_ul').on(clickHandler, function (e) {        e.stopPropagation();    });    $(document).on(clickHandler, function () {        if ($('.languages_ul').hasClass('languages_ul_hover')) {            $('.languages_ul').hide().removeClass('languages_ul_hover');            $('.current_language').removeClass('active');        }    });}function initStickyMenu(){    var menuSticked = false;    var stickTheMenu = function(){        // Hide the menu if there is an open one        $('#wpmegamenu-main .menu-items.active').removeClass('active').fadeOut(250);        menuSticked = true;        $('#sticky-menu-wrapper').hide().stop(true,true);        $('#logo > a').appendTo($('#sticky-logo'));        $('#wpmegamenu-main').appendTo($('#sticky-menu'));                $('#header_shopping_cart').appendTo($('#sticky-cart'));             $('#header_cart_block').hide();                $('#sticky-menu-wrapper').fadeIn('fast').stop(true,true);        //was before: $('#sticky-menu-wrapper').fadeIn('fast');    };    var unstickTheMenu = function(){        // Hide the menu if there is an open one        $('#wpmegamenu-main .menu-items.active').removeClass('active').fadeOut(250);        menuSticked = false;        $('#sticky-menu-wrapper').fadeOut('normal').stop(true,true);        // was before: $('#sticky-menu-wrapper').fadeOut('normal');        $('#wpmegamenu-main').appendTo($('#header_menu'));                $('#header_shopping_cart').appendTo($('#header_cart_wrapper'));                $('#sticky-logo > a').appendTo($('#logo'));    };    if ($('#sticky-menu').length > 0)    {        // Get the header height        var triggerHeight = parseInt($('#header').height());        // Do the stuff        if (!Modernizr.mq('only screen and (max-width: 1023px)')) {            if ($(this).scrollTop() >= (triggerHeight+30) && !menuSticked)                stickTheMenu();        } else {            $('#sticky-menu-wrapper').hide().stop(true,true);        }        // Bind the stuff        $(window).on('scroll', function(){            if (!Modernizr.mq('only screen and (max-width: 1023px)')) {                if ($(this).scrollTop() < triggerHeight) {                    if (menuSticked)                        unstickTheMenu()                } else {                    if ($(this).scrollTop() >= triggerHeight + 30)                    if (!menuSticked)                        stickTheMenu();                }            }        });        $(window).on('resize', function(){            if (Modernizr.mq('only screen and (max-width: 1023px)')) {                if (menuSticked)                    unstickTheMenu();            } else {                if ($(this).scrollTop() >= triggerHeight && !menuSticked)                    stickTheMenu();            }        });    }}function initTabs(){    var clickHandler = 'click';    if (Modernizr.touch) {        clickHandler = 'touchstart';    }    $('.tabs').each(function(){       $(this).find('.tab-title').first().addClass('active');       $(this).find('.tab-content-wrapper').first().addClass('active');    });    $('.tabs .tab-title').on(clickHandler, function(e){        e.preventDefault();        if ($(this).hasClass('active')){            return;        }        var $_tabs = $(this).closest('.tabs');        var tabContentID = $(this).attr('data-tab');        $_tabs.find('.tab-title').removeClass('active');        $_tabs.find('.tab-content-wrapper').removeClass('active');        $(this).addClass('active');        $('.tabs .tab-titles').find("[data-tab='" + tabContentID + "']").addClass('active');        $('#' + tabContentID).addClass('active');    });}function initFooterCollapsables(){    var clickHandler = 'click';    if (Modernizr.touch) {        clickHandler = 'touchstart';    }    $('#main-footer .footer-block > h4 > span').on(clickHandler, function(){        if ($(this).parent().next('div').is(':visible')){            $(this).parent().next('div').hide();            $(this).toggleClass('wpicon-plus wpicon-minus');        } else {            $(this).parent().next('div').show();            $(this).toggleClass('wpicon-plus wpicon-minus');        }    });}