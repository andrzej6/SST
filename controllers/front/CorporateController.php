<?phpclass CorporateController extends FrontController {public $php_self = 'corporate';public function postProcess()	{	if (Tools::isSubmit('submitcMessage'))		{									$regtitle = Tools::getValue('corp_title');			$fn = Tools::getValue('fname');			$ln = Tools::getValue('lname');			$replyto = Tools::getValue('corp_email');			$wphone = Tools::getValue('corp_phone');						$mphone = Tools::getValue('mphone');			$en = Tools::getValue('ename');			$address_line1 = Tools::getValue('address1');            $address_line2 = Tools::getValue('address2');			            $zip = Tools::getValue('postcode');            $job = Tools::getValue('position');            $dep = Tools::getValue('dep');							        $workplace_basic_size = Tools::getValue('workplace_basic_size');	        $workplace_extra = Tools::getValue('workplace_extra');	        $workplace_extra_size = Tools::getValue('workplace_extra_size');	             $hear_from = Tools::getValue('hear_from');			$comments = Tools::getValue('comments');            			if (!empty($_POST['additional']))                  foreach($_POST['additional'] as $add)                         $additional .= $add.', ';									if (!Validate::isEmail($replyto))				$this->errors[] = Tools::displayError('Invalid email address.');						else 				{										if (!count($this->errors))				   {					  					  					  try {					  							                     $username = 'gbs2_7a8le';                     $password = 'ZuLu12^*)(';					  					  $conn = new PDO('mysql:host=localhost;dbname=gbs2_prestashop', $username, $password);                      $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);                     date_default_timezone_set('Europe/London');                                          $q1 = "INSERT INTO ps_corporates (title, first_name, last_name, email, workphone, mobilephone, employername, address_line1, address_line2, postcode, jobposition, department, workplace_basic_size, workplace_extra, workplace_extra_size, hear_from, question, date_created, preform, trial_prod, trial_loc, trial_who)                                              VALUES (:title, :first_name, :last_name, :email, :workphone, :mobilephone, :employername,:address_line1, :address_line2, :postcode, :jobposition, :department, :workplace_basic_size,:workplace_extra, :workplace_extra_size, :hear_from, :question, :date_created, :preform, :trial_prod, :trial_loc, :trial_who)";                             $stmt = $conn->prepare($q1);                     $result1 = $stmt->execute(array(                                             ':title'=>$regtitle,                                              ':first_name'=>$fn,                                              ':last_name'=>$ln,                                              ':email'=>$replyto,                                               ':workphone'=>$wphone,                                              ':mobilephone'=>$mphone,                                              ':employername'=>$en,                                              ':address_line1'=>$address_line1,                                              ':address_line2'=>$address_line2,                                              ':postcode'=>$zip,                                               ':jobposition'=>$job,                                              ':department'=>$dep,                                               ':workplace_basic_size'=>$workplace_basic_size,                                              ':workplace_extra'=>$workplace_extra,                                              ':workplace_extra_size'=>$workplace_extra_size,                                              ':hear_from'=>$hear_from,                                              ':question'=>$comments,                                              ':date_created'=>date("Y-m-d H:i:s",time()),                                              ':preform'=>$additional,                                              ':trial_prod'=>'',                                              ':trial_loc'=>'',                                              ':trial_who'=>''                                              ));										  																											  $error = 'error';               $ok='';               $to      = 'web@sit-stand.com';              $subject = 'Sit-Stand.Com - Corporate Sales Application';               $message = '<html>               <head>               <style>                    body {background-color:lightgray}                    h1, h3   {color:red}                    p    {color:green}					table {border: 1px solid red;}               </style>               </head>               <body>';			   			                  $message .='<h1>SIT-STAND.COM. </h1><br/><h3>Below are details of the person registered on Corporate Sales Registration</h3>';               $message .= '<table rules="all" style="border-color: red; color:red;" cellpadding="10">';			                  $fullname = $regtitle.' '.$fn.' '.$ln;               $message .= "<tr><td><strong>Name:</strong> </td><td>" . strip_tags($fullname) . "</td></tr>";              $message .= "<tr><td><strong>Email:</strong> </td><td>" . strip_tags($replyto) . "</td></tr>";              $message .= "<tr><td><strong>Work phone number:</strong> </td><td>" . strip_tags($wphone) . "</td></tr>";              $message .= "<tr><td><strong>Mobile phone number:</strong> </td><td>" . strip_tags($mphone) . "</td></tr>";			  $message .= "<tr><td><strong>Employer name:</strong> </td><td>" . strip_tags($en) . "</td></tr>";			  	  			  $address = $address_line1.' , '.$address_line2;			  $message .= "<tr><td><strong>Address:</strong> </td><td>" . strip_tags($address) . "</td></tr>";              $message .= "<tr><td><strong>Postcode:</strong> </td><td>" . strip_tags($zip) . "</td></tr>";              $message .= "<tr><td><strong>Job position:</strong> </td><td>" . strip_tags($job) . "</td></tr>";              $message .= "<tr><td><strong>Department:</strong> </td><td>" . strip_tags($dep) . "</td></tr>";			  $message .= "<tr><td><strong>Workplace employees:</strong> </td><td>" . strip_tags($workplace_basic_size) . "</td></tr>";			  $message .= "<tr><td><strong>Number worksites</strong> </td><td>" . strip_tags($workplace_extra) . "</td></tr>";			  $message .= "<tr><td><strong>Additional employees:</strong> </td><td>" . strip_tags($workplace_extra_size) . "</td></tr>";              $message .= "<tr><td><strong>Hear from:</strong> </td><td>" . strip_tags($hear_from) . "</td></tr>";			  $message .= "<tr><td><strong>Additional comments:</strong> </td><td>" . strip_tags($comments) . "</td></tr>";			  $message .= "<tr><td><strong>Checkboxes:</strong> </td><td>" . strip_tags($additional) . "</td></tr>";			  			                              $message .= "</table>";               $message .= "</body></html>";               $headers  = 'MIME-Version: 1.0' . "\r\n";               $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";               // Additional headers                               //$headers .= 'To: Sit-Stand Support <info@sit-stand.com>, Rik <rik@sit-stand.com>' . "\r\n";                          $headers .= 'To: Sit-Stand Support <sales@sit-stand.com>' . "\r\n";                              $headers .= 'From: Corporate Sales Registration <support-team@sit-stand.com>' . "\r\n";              if ( mail($to, $subject, $message, $headers)? $ok : $error =='error')			        $this->errors[] = Tools::displayError('Failed sending email'); 															     $error1 = 'error';         $ok1='';         $to      = $replyto;         $subject1 = 'Thank you for your application';        $message1 = '<html><style>body {font-family:Arial;font-size:10pt}</style>                      <body><div style="color:black;">';        $message1 .= 'Dear '.$fn.',<br/><br/>                      Thank you for registering with us.                       One of our team will be calling you soon to assist with the specifics of your enquiry.<br/><br/>                      We look forward to speaking with you.                      <br/><br/>';		  		 		 $message1 .='	 <span style="color:#da3b44;">Customer Operations Team</span><br/>						  SIT-STAND TRADING Ltd<br/><br/>                         20-22 Wenlock Road, London N1 7GU<br/><br/>                         						   T: 0333 220 0375   						         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>       						   E: <a href="mailto:info@sit-stand.com" target="_top">info@sit-stand.com</a>           						         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>						   W: <a href="https://sit-stand.com" target="_top" style="color:#da3b44;">www.sit-stand.com</a>						   						   <br/><br/>                         Registered in England and Wales No.8994572                         &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 						 VAT registration number: UK   189 7739 28						 <br/><br/>						 						 <a href="https://sit-stand.com">		                     <img src="https://sit-stand.com/img/sit-stand-warehouse-1422836185.jpg" width="280"/>		                  </a>		                  						  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;						  <img src="https://sit-stand.com/img/shop/round1.png"/>						  <img src="https://sit-stand.com/img/shop/round2.png"/>						  <img src="https://sit-stand.com/img/shop/round3.png"/>						  <br/><br/>						  <span style="color:#da3b44;font-size:8pt">This message (including any attachments) is confidential. 						  If you have received it by mistake, please notify the sender by a return e-mail and delete 						  this message from your system. Any unauthorized use or dissemination of this message in 						  whole or in part is strictly prohibited. Thank you.</span>						  						                        </div>';         $message1 .= '</div></body></html>';         $headers1  = 'MIME-Version: 1.0' . "\r\n";         $headers1 .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";         $headers1 .= 'From: SIT-STAND TRADING Ltd <info@sit-stand.com>' . "\r\n";        if ( mail($to, $subject1, $message1, $headers1)? $ok1 : $error1 =='error')			        $this->errors[] = Tools::displayError('Failed sending email');   																	  					  					  }					  catch(Exception $e)					  {					  	$this->errors[] = $e->getMessage();					  }					  					  					  					  					  					  				   }				   				   				   if (count($this->errors) > 1)					array_unique($this->errors);				else					$this->context->smarty->assign('confirmation', 1);				   										}								}						}public function setMedia()	{		parent::setMedia();		$this->addCSS(_THEME_CSS_DIR_.'corporate.css');		$this->addJS(_THEME_JS_DIR_.'corporate.js');	}public function init() {    parent::init();					}public function initContent() {    parent::initContent();		$name = Tools::getValue('cname');	$from = Tools::getValue('from');		$this->context->smarty->assign(array(			'errors' => $this->errors,			'name'=>$name,			'email' => $from,		));		    $this->setTemplate(_PS_THEME_DIR_.'corporate.tpl');              }}